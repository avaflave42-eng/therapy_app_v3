flowchart TB
  subgraph Frontend [Frontend]
    UI[System Map + Intake + Booking UI]
    SDK[Supabase Client / Stripe.js]
  end

  subgraph Backend [Next API Routes]
    PI[/POST /api/payments/intent/]
    WH[/POST /api/stripe/webhook/]
    Intake[/POST /api/intake/]
    Booking[/POST /api/bookings/]
  end

  subgraph Data [Supabase]
    Auth[(Auth)]
    DB[(Postgres: patients, practitioners, bookings, eligibility_snapshots)]
  end

  UI --> SDK
  SDK --> PI
  PI --> Stripe[(Stripe)]
  Stripe --> WH
  Backend --> DB
  Backend --> Auth
